---
interface FAQItem {
  question: string;
  answer: string;
}

interface Props {
  faqs: FAQItem[];
  heading?: string;
}

const { faqs, heading = "Frequently Asked Questions" } = Astro.props;
---

<section class="mt-16 pt-16 border-t border-gray-200" aria-labelledby="faq-heading">
  <h2 id="faq-heading" class="text-2xl md:text-3xl font-bold text-gray-900 mb-8">{heading}</h2>

  <div class="space-y-0 divide-y divide-gray-200">
    {faqs.map((faq, index) => (
      <div class="faq-item py-6" data-faq-item>
        <button
          type="button"
          class="faq-button w-full flex items-start justify-between text-left gap-4"
          aria-expanded="false"
          aria-controls={`faq-answer-${index}`}
          data-faq-button
        >
          <span class="text-lg font-medium text-gray-900">{faq.question}</span>
          <svg
            class="faq-icon w-6 h-6 flex-shrink-0 text-gray-500 transition-transform duration-200"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            aria-hidden="true"
          >
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
          </svg>
        </button>
        <div
          id={`faq-answer-${index}`}
          class="faq-content hidden mt-4 text-gray-600 leading-relaxed"
          data-faq-content
        >
          <p>{faq.answer}</p>
        </div>
      </div>
    ))}
  </div>
</section>

<script>
  document.querySelectorAll('[data-faq-button]').forEach((button) => {
    button.addEventListener('click', () => {
      const expanded = button.getAttribute('aria-expanded') === 'true';
      const content = button.parentElement?.querySelector('[data-faq-content]');
      const icon = button.querySelector('.faq-icon');

      button.setAttribute('aria-expanded', (!expanded).toString());

      if (content) {
        content.classList.toggle('hidden', expanded);
      }

      if (icon) {
        icon.classList.toggle('rotate-180', !expanded);
      }
    });
  });
</script>
